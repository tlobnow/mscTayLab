---
title: "BROWSE TIR-DC FAMILIES"
author: "Finn Lo"
date: "2023-01-04"
output: html_document
---

```{r, echo=F, message=F, warning=F}
source("https://raw.githubusercontent.com/tlobnow/mscTayLab/main/scripts/functions.R")
library(htmltools)
library(knitr)

LOC     = "~/Documents/Github/mscTayLab/fasta_files/GERDOL/"
METHOD  = "kalign" #c(Muscle, ClustalW, ClustalOmega, kalign)
```


### TIR-DC1

![](https://raw.githubusercontent.com/tlobnow/mscTayLab/main/figures/TIR-DC1.png)

#### untrimmed TIR-DC1

```{r DC_1-prep-untrimmed, message=F, warning=F, echo=F}
FILE    = "Gerdol_2017_ecTIR-DC_1"
FASTA   = paste0(LOC,FILE,"/",FILE,".msa.",METHOD,".aln.fasta")
dbConn <- dbConnect(SQLite(), ":memory:")
Seqs2DB(FASTA, "FASTA", dbConn, paste0(FILE), verbose = F)
desc <- dbGetQuery(dbConn, "select description from Seqs")
Add2DB(data.frame(desc=desc, stringsAsFactors=FALSE), dbConn, verbose = F)
Add2DB(data.frame(identifier=desc, stringsAsFactors=FALSE), dbConn, verbose = F)
aa <- SearchDB(dbConn, verbose = F)
amplicon <- subseq(aa)
names(amplicon) <- desc$description
```

```{r DC_1-vis-untrimmed, results = 'asis', echo = FALSE}
TF <- tempfile()
BrowseSeqs(amplicon, htmlFile = TF)
cat(htmltools::includeHTML(TF))
```

#### trimmed TIR-DC1

```{r DC_1-prep-trimmed, message=F, warning=F, echo=F}
FILE    = "Gerdol_2017_ecTIR-DC_1"
system(command = paste0("~/Documents/Github/mscTayLab/scripts/run_kalign.sh ", FILE))
FASTA   = paste0(LOC,FILE,"/",FILE,".msa.",METHOD,".aln.trim2.fasta")
dbConn <- dbConnect(SQLite(), ":memory:")
Seqs2DB(FASTA, "FASTA", dbConn, paste0(FILE), verbose = F)
desc <- dbGetQuery(dbConn, "select description from Seqs")
Add2DB(data.frame(desc=desc, stringsAsFactors=FALSE), dbConn, verbose = F)
Add2DB(data.frame(identifier=desc, stringsAsFactors=FALSE), dbConn, verbose = F)
aa <- SearchDB(dbConn, verbose = F)
amplicon <- subseq(aa)
names(amplicon) <- desc$description
```

```{r DC_1-vis-trimmed, results = 'asis', echo = FALSE}
TF <- tempfile()
BrowseSeqs(amplicon, htmlFile = TF)
cat(htmltools::includeHTML(TF))
```

### TIR-DC2

![](https://raw.githubusercontent.com/tlobnow/mscTayLab/main/figures/TIR-DC2.png)

#### untrimmed TIR-DC2

```{r DC_2-prep-untrimmed, message=F, warning=F, echo=F}
FILE    = "Gerdol_2017_ecTIR-DC_2"
FASTA   = paste0(LOC,FILE,"/",FILE,".msa.",METHOD,".aln.fasta")
dbConn <- dbConnect(SQLite(), ":memory:")
Seqs2DB(FASTA, "FASTA", dbConn, paste0(FILE), verbose = F)
desc <- dbGetQuery(dbConn, "select description from Seqs")
Add2DB(data.frame(desc=desc, stringsAsFactors=FALSE), dbConn, verbose = F)
Add2DB(data.frame(identifier=desc, stringsAsFactors=FALSE), dbConn, verbose = F)
aa <- SearchDB(dbConn, verbose = F)
amplicon <- subseq(aa)
names(amplicon) <- desc$description
```

```{r DC_2-vis-untrimmed, results = 'asis', echo = FALSE}
TF <- tempfile()
BrowseSeqs(amplicon, htmlFile = TF)
cat(htmltools::includeHTML(TF))
```

#### trimmed TIR-DC2

```{r DC_2-prep-trimmed, message=F, warning=F, echo=F}
FILE    = "Gerdol_2017_ecTIR-DC_2"
system(command = paste0("[-f ", LOC, FILE,"/",FILE,".msa.",METHOD,".aln.trim2.fasta] || ~/Documents/Github/mscTayLab/scripts/run_kalign.sh ", FILE))
FASTA   = paste0(LOC,FILE,"/",FILE,".msa.",METHOD,".aln.trim2.fasta")
dbConn <- dbConnect(SQLite(), ":memory:")
Seqs2DB(FASTA, "FASTA", dbConn, paste0(FILE), verbose = F)
desc <- dbGetQuery(dbConn, "select description from Seqs")
Add2DB(data.frame(desc=desc, stringsAsFactors=FALSE), dbConn, verbose = F)
Add2DB(data.frame(identifier=desc, stringsAsFactors=FALSE), dbConn, verbose = F)
aa <- SearchDB(dbConn, verbose = F)
amplicon <- subseq(aa)
names(amplicon) <- desc$description
```

```{r DC_2-vis-trimmed, results = 'asis', echo = FALSE}
TF <- tempfile()
BrowseSeqs(amplicon, htmlFile = TF)
cat(htmltools::includeHTML(TF))
```

### TIR-DC3

![](https://raw.githubusercontent.com/tlobnow/mscTayLab/main/figures/TIR-DC3.png)

#### untrimmed TIR-DC3

```{r DC_3-prep-untrimmed, message=F, warning=F, echo=F}
FILE    = "Gerdol_2017_ecTIR-DC_3"
FASTA   = paste0(LOC,FILE,"/",FILE,".msa.",METHOD,".aln.fasta")
dbConn <- dbConnect(SQLite(), ":memory:")
Seqs2DB(FASTA, "FASTA", dbConn, paste0(FILE), verbose = F)
desc <- dbGetQuery(dbConn, "select description from Seqs")
Add2DB(data.frame(desc=desc, stringsAsFactors=FALSE), dbConn, verbose = F)
Add2DB(data.frame(identifier=desc, stringsAsFactors=FALSE), dbConn, verbose = F)
aa <- SearchDB(dbConn, verbose = F)
amplicon <- subseq(aa)
names(amplicon) <- desc$description
```

```{r DC_3-vis-untrimmed, results = 'asis', echo = FALSE}
TF <- tempfile()
BrowseSeqs(amplicon, htmlFile = TF)
cat(htmltools::includeHTML(TF))
```

#### trimmed TIR-DC3-L

```{r DC_3-prep-trimmed-L, message=F, warning=F, echo=F}
FILE    = "Gerdol_2017_ecTIR-DC_3"
system(command = paste0("[-f ", LOC, FILE,"/",FILE,".msa.",METHOD,".aln.trim2.R.fasta] || ~/Documents/Github/mscTayLab/scripts/run_kalign.sh ", FILE))
FASTA   = paste0(LOC,FILE,"/",FILE,".msa.",METHOD,".aln.trim2.L.fasta")
dbConn <- dbConnect(SQLite(), ":memory:")
Seqs2DB(FASTA, "FASTA", dbConn, paste0(FILE), verbose = F)
desc <- dbGetQuery(dbConn, "select description from Seqs")
Add2DB(data.frame(desc=desc, stringsAsFactors=FALSE), dbConn, verbose = F)
Add2DB(data.frame(identifier=desc, stringsAsFactors=FALSE), dbConn, verbose = F)
aa <- SearchDB(dbConn, verbose = F)
amplicon <- subseq(aa)
names(amplicon) <- desc$description
```

```{r DC_3-vis-trimmed-L, results = 'asis', echo = FALSE}
TF <- tempfile()
BrowseSeqs(amplicon, htmlFile = TF)
cat(htmltools::includeHTML(TF))
```

#### trimmed TIR-DC3-R

```{r DC_3-prep-trimmed-R, message=F, warning=F, echo=F}
FILE    = "Gerdol_2017_ecTIR-DC_3"
system(command = paste0("[-f ", LOC, FILE,"/",FILE,".msa.",METHOD,".aln.trim2.R.fasta] || ~/Documents/Github/mscTayLab/scripts/run_kalign.sh ", FILE))
FASTA   = paste0(LOC,FILE,"/",FILE,".msa.",METHOD,".aln.trim2.R.fasta")
dbConn <- dbConnect(SQLite(), ":memory:")
Seqs2DB(FASTA, "FASTA", dbConn, paste0(FILE), verbose = F)
desc <- dbGetQuery(dbConn, "select description from Seqs")
Add2DB(data.frame(desc=desc, stringsAsFactors=FALSE), dbConn, verbose = F)
Add2DB(data.frame(identifier=desc, stringsAsFactors=FALSE), dbConn, verbose = F)
aa <- SearchDB(dbConn, verbose = F)
amplicon <- subseq(aa)
names(amplicon) <- desc$description
```

```{r DC_3-vis-trimmed-R, results = 'asis', echo = FALSE}
TF <- tempfile()
BrowseSeqs(amplicon, htmlFile = TF)
cat(htmltools::includeHTML(TF))
```

### TIR-DC4

![](https://raw.githubusercontent.com/tlobnow/mscTayLab/main/figures/TIR-DC4.png)

#### untrimmed TIR-DC4

```{r DC_4-prep-untrimmed, message=F, warning=F, echo=F}
FILE    = "Gerdol_2017_ecTIR-DC_4"
FASTA   = paste0(LOC,FILE,"/",FILE,".msa.",METHOD,".aln.fasta")
dbConn <- dbConnect(SQLite(), ":memory:")
Seqs2DB(FASTA, "FASTA", dbConn, paste0(FILE), verbose = F)
desc <- dbGetQuery(dbConn, "select description from Seqs")
Add2DB(data.frame(desc=desc, stringsAsFactors=FALSE), dbConn, verbose = F)
Add2DB(data.frame(identifier=desc, stringsAsFactors=FALSE), dbConn, verbose = F)
aa <- SearchDB(dbConn, verbose = F)
amplicon <- subseq(aa)
names(amplicon) <- desc$description
```

```{r DC_4-vis-untrimmed, results = 'asis', echo = FALSE}
TF <- tempfile()
BrowseSeqs(amplicon, htmlFile = TF)
cat(htmltools::includeHTML(TF))
```

### TIR-DC5

![](https://raw.githubusercontent.com/tlobnow/mscTayLab/main/figures/TIR-DC5.png)

#### untrimmed TIR-DC5

```{r DC_5-prep-untrimmed, message=F, warning=F, echo=F}
FILE    = "Gerdol_2017_ecTIR-DC_5"
FASTA   = paste0(LOC,FILE,"/",FILE,".msa.",METHOD,".aln.fasta")
dbConn <- dbConnect(SQLite(), ":memory:")
Seqs2DB(FASTA, "FASTA", dbConn, paste0(FILE), verbose = F)
desc <- dbGetQuery(dbConn, "select description from Seqs")
Add2DB(data.frame(desc=desc, stringsAsFactors=FALSE), dbConn, verbose = F)
Add2DB(data.frame(identifier=desc, stringsAsFactors=FALSE), dbConn, verbose = F)
aa <- SearchDB(dbConn, verbose = F)
amplicon <- subseq(aa)
names(amplicon) <- desc$description
```

```{r DC_5-vis-untrimmed, results = 'asis', echo = FALSE}
TF <- tempfile()
BrowseSeqs(amplicon, htmlFile = TF)
cat(htmltools::includeHTML(TF))
```



